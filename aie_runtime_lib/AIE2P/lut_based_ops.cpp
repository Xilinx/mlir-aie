//===---  lut_based_ops.cpp - lookup table based operations ---===//
//
// This file is licensed under the Apache License v2.0 with LLVM Exceptions
// See https://llvm.org/LICENSE.txt for license information.
// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
//
// (c) Copyright 2023 Xilinx Inc.
//
//
//===----------------------------------------------------------------------===//
// Lookup table based operations
//===----------------------------------------------------------------------===//

#include "aie_api/aie.hpp"

// The tables _ab and _cd are copies of each other
// Also, each table has a copy of data seperated by 256-bit
// This effectively creates 4 copies of the table (located in 4 (256-bit) banks)
// This allows the user to use the "gather" read feature and read 4 values from
// 4 different banks at once Tables entries are in BF16
//
alignas(aie::vector_decl_align) int16 exp_ilut_ab[512] = {
    16256, 16430, 16620, 16801, 16986, 17172, 17354, 17545, 17722, 17917, 18092,
    18282, 18463, 18648, 18835, 19016, 16256, 16430, 16620, 16801, 16986, 17172,
    17354, 17545, 17722, 17917, 18092, 18282, 18463, 18648, 18835, 19016, 19208,
    19384, 19578, 19754, 19943, 20125, 20310, 20497, 20677, 20870, 21046, 21240,
    21416, 21605, 21788, 21971, 19208, 19384, 19578, 19754, 19943, 20125, 20310,
    20497, 20677, 20870, 21046, 21240, 21416, 21605, 21788, 21971, 22160, 22339,
    22533, 22708, 22901, 23079, 23266, 23450, 23633, 23822, 24001, 24195, 24370,
    24562, 24741, 24928, 22160, 22339, 22533, 22708, 22901, 23079, 23266, 23450,
    23633, 23822, 24001, 24195, 24370, 24562, 24741, 24928, 25112, 25295, 25485,
    25663, 25858, 26032, 26224, 26403, 26589, 26774, 26957, 27147, 27325, 27520,
    27695, 27885, 25112, 25295, 25485, 25663, 25858, 26032, 26224, 26403, 26589,
    26774, 26957, 27147, 27325, 27520, 27695, 27885, 28065, 28251, 28437, 28618,
    28809, 28987, 29182, 29357, 29547, 29727, 29913, 30099, 30280, 30472, 30649,
    30843, 28065, 28251, 28437, 28618, 28809, 28987, 29182, 29357, 29547, 29727,
    29913, 30099, 30280, 30472, 30649, 30843, 31019, 31208, 31390, 31574, 31762,
    31942, 32135, 32311, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    31019, 31208, 31390, 31574, 31762, 31942, 32135, 32311, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     1,     3,     9,     24,    66,    179,
    372,   550,   737,   921,   1104,  1293,  0,     0,     0,     0,     1,
    3,     9,     24,    66,    179,   372,   550,   737,   921,   1104,  1293,
    1472,  1666,  1841,  2033,  2212,  2399,  2583,  2766,  2956,  3134,  3329,
    3503,  3694,  3874,  4060,  4246,  1472,  1666,  1841,  2033,  2212,  2399,
    2583,  2766,  2956,  3134,  3329,  3503,  3694,  3874,  4060,  4246,  4427,
    4618,  4796,  4991,  5165,  5356,  5536,  5722,  5908,  6089,  6281,  6458,
    6652,  6828,  7017,  7198,  4427,  4618,  4796,  4991,  5165,  5356,  5536,
    5722,  5908,  6089,  6281,  6458,  6652,  6828,  7017,  7198,  7383,  7570,
    7751,  7943,  8120,  8314,  8490,  8679,  8861,  9045,  9233,  9413,  9606,
    9782,  9975,  10152, 7383,  7570,  7751,  7943,  8120,  8314,  8490,  8679,
    8861,  9045,  9233,  9413,  9606,  9782,  9975,  10152, 10340, 10523, 10707,
    10895, 11075, 11268, 11444, 11636, 11814, 12002, 12185, 12368, 12558, 12737,
    12931, 13106, 10340, 10523, 10707, 10895, 11075, 11268, 11444, 11636, 11814,
    12002, 12185, 12368, 12558, 12737, 12931, 13106, 13298, 13476, 13663, 13848,
    14030, 14220, 14398, 14593, 14768, 14959, 15138, 15325, 15510, 15692, 15883,
    16060, 13298, 13476, 13663, 13848, 14030, 14220, 14398, 14593, 14768, 14959,
    15138, 15325, 15510, 15692, 15883, 16060};

alignas(aie::vector_decl_align) int16 exp_ilut_cd[512] = {
    16256, 16430, 16620, 16801, 16986, 17172, 17354, 17545, 17722, 17917, 18092,
    18282, 18463, 18648, 18835, 19016, 16256, 16430, 16620, 16801, 16986, 17172,
    17354, 17545, 17722, 17917, 18092, 18282, 18463, 18648, 18835, 19016, 19208,
    19384, 19578, 19754, 19943, 20125, 20310, 20497, 20677, 20870, 21046, 21240,
    21416, 21605, 21788, 21971, 19208, 19384, 19578, 19754, 19943, 20125, 20310,
    20497, 20677, 20870, 21046, 21240, 21416, 21605, 21788, 21971, 22160, 22339,
    22533, 22708, 22901, 23079, 23266, 23450, 23633, 23822, 24001, 24195, 24370,
    24562, 24741, 24928, 22160, 22339, 22533, 22708, 22901, 23079, 23266, 23450,
    23633, 23822, 24001, 24195, 24370, 24562, 24741, 24928, 25112, 25295, 25485,
    25663, 25858, 26032, 26224, 26403, 26589, 26774, 26957, 27147, 27325, 27520,
    27695, 27885, 25112, 25295, 25485, 25663, 25858, 26032, 26224, 26403, 26589,
    26774, 26957, 27147, 27325, 27520, 27695, 27885, 28065, 28251, 28437, 28618,
    28809, 28987, 29182, 29357, 29547, 29727, 29913, 30099, 30280, 30472, 30649,
    30843, 28065, 28251, 28437, 28618, 28809, 28987, 29182, 29357, 29547, 29727,
    29913, 30099, 30280, 30472, 30649, 30843, 31019, 31208, 31390, 31574, 31762,
    31942, 32135, 32311, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    31019, 31208, 31390, 31574, 31762, 31942, 32135, 32311, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505, 32505,
    32505, 32505, 32505, 0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     0,     0,     0,     0,     0,     0,
    0,     0,     0,     0,     0,     1,     3,     9,     24,    66,    179,
    372,   550,   737,   921,   1104,  1293,  0,     0,     0,     0,     1,
    3,     9,     24,    66,    179,   372,   550,   737,   921,   1104,  1293,
    1472,  1666,  1841,  2033,  2212,  2399,  2583,  2766,  2956,  3134,  3329,
    3503,  3694,  3874,  4060,  4246,  1472,  1666,  1841,  2033,  2212,  2399,
    2583,  2766,  2956,  3134,  3329,  3503,  3694,  3874,  4060,  4246,  4427,
    4618,  4796,  4991,  5165,  5356,  5536,  5722,  5908,  6089,  6281,  6458,
    6652,  6828,  7017,  7198,  4427,  4618,  4796,  4991,  5165,  5356,  5536,
    5722,  5908,  6089,  6281,  6458,  6652,  6828,  7017,  7198,  7383,  7570,
    7751,  7943,  8120,  8314,  8490,  8679,  8861,  9045,  9233,  9413,  9606,
    9782,  9975,  10152, 7383,  7570,  7751,  7943,  8120,  8314,  8490,  8679,
    8861,  9045,  9233,  9413,  9606,  9782,  9975,  10152, 10340, 10523, 10707,
    10895, 11075, 11268, 11444, 11636, 11814, 12002, 12185, 12368, 12558, 12737,
    12931, 13106, 10340, 10523, 10707, 10895, 11075, 11268, 11444, 11636, 11814,
    12002, 12185, 12368, 12558, 12737, 12931, 13106, 13298, 13476, 13663, 13848,
    14030, 14220, 14398, 14593, 14768, 14959, 15138, 15325, 15510, 15692, 15883,
    16060, 13298, 13476, 13663, 13848, 14030, 14220, 14398, 14593, 14768, 14959,
    15138, 15325, 15510, 15692, 15883, 16060};

alignas(aie::vector_decl_align) int16 exp_flut_ab[512] = {
    16256, 16257, 16257, 16258, 16258, 16259, 16259, 16260, 16260, 16261, 16261,
    16262, 16262, 16263, 16263, 16264, 16256, 16257, 16257, 16258, 16258, 16259,
    16259, 16260, 16260, 16261, 16261, 16262, 16262, 16263, 16263, 16264, 16264,
    16265, 16265, 16266, 16266, 16267, 16267, 16268, 16269, 16269, 16270, 16270,
    16271, 16271, 16272, 16272, 16264, 16265, 16265, 16266, 16266, 16267, 16267,
    16268, 16269, 16269, 16270, 16270, 16271, 16271, 16272, 16272, 16273, 16274,
    16274, 16275, 16275, 16276, 16276, 16277, 16278, 16278, 16279, 16279, 16280,
    16281, 16281, 16282, 16273, 16274, 16274, 16275, 16275, 16276, 16276, 16277,
    16278, 16278, 16279, 16279, 16280, 16281, 16281, 16282, 16282, 16283, 16284,
    16284, 16285, 16285, 16286, 16287, 16287, 16288, 16289, 16289, 16290, 16290,
    16291, 16292, 16282, 16283, 16284, 16284, 16285, 16285, 16286, 16287, 16287,
    16288, 16289, 16289, 16290, 16290, 16291, 16292, 16292, 16293, 16294, 16294,
    16295, 16296, 16296, 16297, 16298, 16298, 16299, 16300, 16300, 16301, 16302,
    16302, 16292, 16293, 16294, 16294, 16295, 16296, 16296, 16297, 16298, 16298,
    16299, 16300, 16300, 16301, 16302, 16302, 16303, 16304, 16304, 16305, 16306,
    16306, 16307, 16308, 16309, 16309, 16310, 16311, 16311, 16312, 16313, 16314,
    16303, 16304, 16304, 16305, 16306, 16306, 16307, 16308, 16309, 16309, 16310,
    16311, 16311, 16312, 16313, 16314, 16314, 16315, 16316, 16316, 16317, 16318,
    16319, 16319, 16320, 16321, 16322, 16322, 16323, 16324, 16325, 16325, 16314,
    16315, 16316, 16316, 16317, 16318, 16319, 16319, 16320, 16321, 16322, 16322,
    16323, 16324, 16325, 16325, 16326, 16327, 16328, 16329, 16329, 16330, 16331,
    16332, 16333, 16333, 16334, 16335, 16336, 16337, 16337, 16338, 16326, 16327,
    16328, 16329, 16329, 16330, 16331, 16332, 16333, 16333, 16334, 16335, 16336,
    16337, 16337, 16338, 16339, 16340, 16341, 16342, 16342, 16343, 16344, 16345,
    16346, 16347, 16347, 16348, 16349, 16350, 16351, 16352, 16339, 16340, 16341,
    16342, 16342, 16343, 16344, 16345, 16346, 16347, 16347, 16348, 16349, 16350,
    16351, 16352, 16353, 16354, 16354, 16355, 16356, 16357, 16358, 16359, 16360,
    16361, 16362, 16363, 16363, 16364, 16365, 16366, 16353, 16354, 16354, 16355,
    16356, 16357, 16358, 16359, 16360, 16361, 16362, 16363, 16363, 16364, 16365,
    16366, 16367, 16368, 16369, 16370, 16371, 16372, 16373, 16374, 16375, 16376,
    16377, 16378, 16379, 16380, 16381, 16382, 16367, 16368, 16369, 16370, 16371,
    16372, 16373, 16374, 16375, 16376, 16377, 16378, 16379, 16380, 16381, 16382,
    16383, 16384, 16384, 16385, 16385, 16386, 16386, 16387, 16387, 16388, 16388,
    16389, 16389, 16390, 16390, 16391, 16383, 16384, 16384, 16385, 16385, 16386,
    16386, 16387, 16387, 16388, 16388, 16389, 16389, 16390, 16390, 16391, 16391,
    16392, 16393, 16393, 16394, 16394, 16395, 16395, 16396, 16396, 16397, 16397,
    16398, 16399, 16399, 16400, 16391, 16392, 16393, 16393, 16394, 16394, 16395,
    16395, 16396, 16396, 16397, 16397, 16398, 16399, 16399, 16400, 16400, 16401,
    16401, 16402, 16402, 16403, 16404, 16404, 16405, 16405, 16406, 16407, 16407,
    16408, 16408, 16409, 16400, 16401, 16401, 16402, 16402, 16403, 16404, 16404,
    16405, 16405, 16406, 16407, 16407, 16408, 16408, 16409, 16410, 16410, 16411,
    16411, 16412, 16413, 16413, 16414, 16414, 16415, 16416, 16416, 16417, 16418,
    16418, 16419, 16410, 16410, 16411, 16411, 16412, 16413, 16413, 16414, 16414,
    16415, 16416, 16416, 16417, 16418, 16418, 16419, 16419, 16420, 16421, 16421,
    16422, 16423, 16423, 16424, 16425, 16425, 16426, 16427, 16427, 16428, 16429,
    16429, 16419, 16420, 16421, 16421, 16422, 16423, 16423, 16424, 16425, 16425,
    16426, 16427, 16427, 16428, 16429, 16429};

alignas(aie::vector_decl_align) int16 exp_flut_cd[512] = {
    16256, 16257, 16257, 16258, 16258, 16259, 16259, 16260, 16260, 16261, 16261,
    16262, 16262, 16263, 16263, 16264, 16256, 16257, 16257, 16258, 16258, 16259,
    16259, 16260, 16260, 16261, 16261, 16262, 16262, 16263, 16263, 16264, 16264,
    16265, 16265, 16266, 16266, 16267, 16267, 16268, 16269, 16269, 16270, 16270,
    16271, 16271, 16272, 16272, 16264, 16265, 16265, 16266, 16266, 16267, 16267,
    16268, 16269, 16269, 16270, 16270, 16271, 16271, 16272, 16272, 16273, 16274,
    16274, 16275, 16275, 16276, 16276, 16277, 16278, 16278, 16279, 16279, 16280,
    16281, 16281, 16282, 16273, 16274, 16274, 16275, 16275, 16276, 16276, 16277,
    16278, 16278, 16279, 16279, 16280, 16281, 16281, 16282, 16282, 16283, 16284,
    16284, 16285, 16285, 16286, 16287, 16287, 16288, 16289, 16289, 16290, 16290,
    16291, 16292, 16282, 16283, 16284, 16284, 16285, 16285, 16286, 16287, 16287,
    16288, 16289, 16289, 16290, 16290, 16291, 16292, 16292, 16293, 16294, 16294,
    16295, 16296, 16296, 16297, 16298, 16298, 16299, 16300, 16300, 16301, 16302,
    16302, 16292, 16293, 16294, 16294, 16295, 16296, 16296, 16297, 16298, 16298,
    16299, 16300, 16300, 16301, 16302, 16302, 16303, 16304, 16304, 16305, 16306,
    16306, 16307, 16308, 16309, 16309, 16310, 16311, 16311, 16312, 16313, 16314,
    16303, 16304, 16304, 16305, 16306, 16306, 16307, 16308, 16309, 16309, 16310,
    16311, 16311, 16312, 16313, 16314, 16314, 16315, 16316, 16316, 16317, 16318,
    16319, 16319, 16320, 16321, 16322, 16322, 16323, 16324, 16325, 16325, 16314,
    16315, 16316, 16316, 16317, 16318, 16319, 16319, 16320, 16321, 16322, 16322,
    16323, 16324, 16325, 16325, 16326, 16327, 16328, 16329, 16329, 16330, 16331,
    16332, 16333, 16333, 16334, 16335, 16336, 16337, 16337, 16338, 16326, 16327,
    16328, 16329, 16329, 16330, 16331, 16332, 16333, 16333, 16334, 16335, 16336,
    16337, 16337, 16338, 16339, 16340, 16341, 16342, 16342, 16343, 16344, 16345,
    16346, 16347, 16347, 16348, 16349, 16350, 16351, 16352, 16339, 16340, 16341,
    16342, 16342, 16343, 16344, 16345, 16346, 16347, 16347, 16348, 16349, 16350,
    16351, 16352, 16353, 16354, 16354, 16355, 16356, 16357, 16358, 16359, 16360,
    16361, 16362, 16363, 16363, 16364, 16365, 16366, 16353, 16354, 16354, 16355,
    16356, 16357, 16358, 16359, 16360, 16361, 16362, 16363, 16363, 16364, 16365,
    16366, 16367, 16368, 16369, 16370, 16371, 16372, 16373, 16374, 16375, 16376,
    16377, 16378, 16379, 16380, 16381, 16382, 16367, 16368, 16369, 16370, 16371,
    16372, 16373, 16374, 16375, 16376, 16377, 16378, 16379, 16380, 16381, 16382,
    16383, 16384, 16384, 16385, 16385, 16386, 16386, 16387, 16387, 16388, 16388,
    16389, 16389, 16390, 16390, 16391, 16383, 16384, 16384, 16385, 16385, 16386,
    16386, 16387, 16387, 16388, 16388, 16389, 16389, 16390, 16390, 16391, 16391,
    16392, 16393, 16393, 16394, 16394, 16395, 16395, 16396, 16396, 16397, 16397,
    16398, 16399, 16399, 16400, 16391, 16392, 16393, 16393, 16394, 16394, 16395,
    16395, 16396, 16396, 16397, 16397, 16398, 16399, 16399, 16400, 16400, 16401,
    16401, 16402, 16402, 16403, 16404, 16404, 16405, 16405, 16406, 16407, 16407,
    16408, 16408, 16409, 16400, 16401, 16401, 16402, 16402, 16403, 16404, 16404,
    16405, 16405, 16406, 16407, 16407, 16408, 16408, 16409, 16410, 16410, 16411,
    16411, 16412, 16413, 16413, 16414, 16414, 16415, 16416, 16416, 16417, 16418,
    16418, 16419, 16410, 16410, 16411, 16411, 16412, 16413, 16413, 16414, 16414,
    16415, 16416, 16416, 16417, 16418, 16418, 16419, 16419, 16420, 16421, 16421,
    16422, 16423, 16423, 16424, 16425, 16425, 16426, 16427, 16427, 16428, 16429,
    16429, 16419, 16420, 16421, 16421, 16422, 16423, 16423, 16424, 16425, 16425,
    16426, 16427, 16427, 16428, 16429, 16429};

alignas(aie::vector_decl_align) unsigned char m_inv_lut[128] = {
    0,   126, 124, 122, 120, 118, 117, 115, 113, 111, 109, 108, 106, 104, 103,
    101, 100, 98,  96,  95,  93,  92,  90,  89,  88,  86,  85,  83,  82,  81,
    79,  78,  77,  76,  74,  73,  72,  71,  69,  68,  67,  66,  65,  64,  63,
    61,  60,  59,  58,  57,  56,  55,  54,  53,  52,  51,  50,  49,  48,  47,
    46,  45,  44,  44,  43,  42,  41,  40,  39,  38,  37,  37,  36,  35,  34,
    33,  33,  32,  31,  30,  30,  29,  28,  27,  27,  26,  25,  24,  24,  23,
    22,  22,  21,  20,  20,  19,  18,  18,  17,  16,  16,  15,  14,  14,  13,
    13,  12,  11,  11,  10,  10,  9,   9,   8,   7,   7,   6,   6,   5,   5,
    4,   4,   3,   3,   2,   2,   1,   1};

// Tanh look up tables: Divides into 32 segments between [-4,4], bank size:
// (32*2*2*4)*2=1k, one lut=512B
float chess_storage(% chess_alignof(v32int8)) tanh_lut_ab[128] = {
    0.00000000000000000000000000000000, -1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, -0.98828125000000000000000000000000,
    0.00509643554687500000000000000000, -0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, -0.97265625000000000000000000000000,
    0.00000000000000000000000000000000, -1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, -0.98828125000000000000000000000000,
    0.00509643554687500000000000000000, -0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, -0.97265625000000000000000000000000,
    0.01269531250000000000000000000000, -0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, -0.93359375000000000000000000000000,
    0.03540039062500000000000000000000, -0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, -0.85156250000000000000000000000000,
    0.01269531250000000000000000000000, -0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, -0.93359375000000000000000000000000,
    0.03540039062500000000000000000000, -0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, -0.85156250000000000000000000000000,
    0.09179687500000000000000000000000, -0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, -0.68750000000000000000000000000000,
    0.22949218750000000000000000000000, -0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, -0.41601562500000000000000000000000,
    0.09179687500000000000000000000000, -0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, -0.68750000000000000000000000000000,
    0.22949218750000000000000000000000, -0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, -0.41601562500000000000000000000000,
    0.50390625000000000000000000000000, -0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, -0.11962890625000000000000000000000,
    0.86718750000000000000000000000000, -0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.50390625000000000000000000000000, -0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, -0.11962890625000000000000000000000,
    0.86718750000000000000000000000000, -0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, 0.03076171875000000000000000000000,
    0.69140625000000000000000000000000, 0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, 0.25976562500000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, 0.03076171875000000000000000000000,
    0.69140625000000000000000000000000, 0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, 0.25976562500000000000000000000000,
    0.34765625000000000000000000000000, 0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, 0.56250000000000000000000000000000,
    0.14550781250000000000000000000000, 0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, 0.78125000000000000000000000000000,
    0.34765625000000000000000000000000, 0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, 0.56250000000000000000000000000000,
    0.14550781250000000000000000000000, 0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, 0.78125000000000000000000000000000,
    0.05639648437500000000000000000000, 0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, 0.89843750000000000000000000000000,
    0.02124023437500000000000000000000, 0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, 0.95703125000000000000000000000000,
    0.05639648437500000000000000000000, 0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, 0.89843750000000000000000000000000,
    0.02124023437500000000000000000000, 0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, 0.95703125000000000000000000000000,
    0.00750732421875000000000000000000, 0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, 0.98046875000000000000000000000000,
    0.00283813476562500000000000000000, 0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, 1.00000000000000000000000000000000,
    0.00750732421875000000000000000000, 0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, 0.98046875000000000000000000000000,
    0.00283813476562500000000000000000, 0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, 1.00000000000000000000000000000000};

float chess_storage(% chess_alignof(v32int8)) tanh_lut_cd[128] = {
    0.00000000000000000000000000000000, -1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, -0.98828125000000000000000000000000,
    0.00509643554687500000000000000000, -0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, -0.97265625000000000000000000000000,
    0.00000000000000000000000000000000, -1.00000000000000000000000000000000,
    0.00283813476562500000000000000000, -0.98828125000000000000000000000000,
    0.00509643554687500000000000000000, -0.98046875000000000000000000000000,
    0.00750732421875000000000000000000, -0.97265625000000000000000000000000,
    0.01269531250000000000000000000000, -0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, -0.93359375000000000000000000000000,
    0.03540039062500000000000000000000, -0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, -0.85156250000000000000000000000000,
    0.01269531250000000000000000000000, -0.95703125000000000000000000000000,
    0.02124023437500000000000000000000, -0.93359375000000000000000000000000,
    0.03540039062500000000000000000000, -0.89843750000000000000000000000000,
    0.05639648437500000000000000000000, -0.85156250000000000000000000000000,
    0.09179687500000000000000000000000, -0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, -0.68750000000000000000000000000000,
    0.22949218750000000000000000000000, -0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, -0.41601562500000000000000000000000,
    0.09179687500000000000000000000000, -0.78125000000000000000000000000000,
    0.14550781250000000000000000000000, -0.68750000000000000000000000000000,
    0.22949218750000000000000000000000, -0.56250000000000000000000000000000,
    0.34765625000000000000000000000000, -0.41601562500000000000000000000000,
    0.50390625000000000000000000000000, -0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, -0.11962890625000000000000000000000,
    0.86718750000000000000000000000000, -0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.50390625000000000000000000000000, -0.25976562500000000000000000000000,
    0.69140625000000000000000000000000, -0.11962890625000000000000000000000,
    0.86718750000000000000000000000000, -0.03076171875000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, 0.03076171875000000000000000000000,
    0.69140625000000000000000000000000, 0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, 0.25976562500000000000000000000000,
    1.00000000000000000000000000000000, 0.00000000000000000000000000000000,
    0.86718750000000000000000000000000, 0.03076171875000000000000000000000,
    0.69140625000000000000000000000000, 0.11962890625000000000000000000000,
    0.50390625000000000000000000000000, 0.25976562500000000000000000000000,
    0.34765625000000000000000000000000, 0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, 0.56250000000000000000000000000000,
    0.14550781250000000000000000000000, 0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, 0.78125000000000000000000000000000,
    0.34765625000000000000000000000000, 0.41601562500000000000000000000000,
    0.22949218750000000000000000000000, 0.56250000000000000000000000000000,
    0.14550781250000000000000000000000, 0.68750000000000000000000000000000,
    0.09179687500000000000000000000000, 0.78125000000000000000000000000000,
    0.05639648437500000000000000000000, 0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, 0.89843750000000000000000000000000,
    0.02124023437500000000000000000000, 0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, 0.95703125000000000000000000000000,
    0.05639648437500000000000000000000, 0.85156250000000000000000000000000,
    0.03540039062500000000000000000000, 0.89843750000000000000000000000000,
    0.02124023437500000000000000000000, 0.93359375000000000000000000000000,
    0.01269531250000000000000000000000, 0.95703125000000000000000000000000,
    0.00750732421875000000000000000000, 0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, 0.98046875000000000000000000000000,
    0.00283813476562500000000000000000, 0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, 1.00000000000000000000000000000000,
    0.00750732421875000000000000000000, 0.97265625000000000000000000000000,
    0.00509643554687500000000000000000, 0.98046875000000000000000000000000,
    0.00283813476562500000000000000000, 0.98828125000000000000000000000000,
    0.00000000000000000000000000000000, 1.00000000000000000000000000000000};
