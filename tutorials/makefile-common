# Contains common definitions used across the Makefiles of all tutorials.

# MLIR-AIE install directory. If you have sourced utils/env_setup.sh before
# running make, the following should work to find the AIE install directory.
AIE_INSTALL ?= $(dir $(shell which aie-opt))/..

# An aarch64 sysroot is required for cross-compiling the host code. The default
# values of these variables assume that you have built a sysroot by running
# make in platforms/vck190_bare_prod, but you can use other aarch64 sysroots by
MLIR_AIE_SYSROOT ?= ${AIE_INSTALL}/../platforms/vck190_bare_prod/aie_platform/sw_comp/sysroots/cortexa72-cortexa53-xilinx-linux

# The libstdc++ version that is installed in the sysroot given above. This is
# used for include and library paths. If you built the sysroot with Vitis
# 2021.2 and PetaLinux 2021.2, libstdc++ 10.2.0 will be installed. 
LIBCXX_VERSION ?= 10.2.0

# The following flags are passed to both AI core and host compilation for
# aiecc.py invocations.
AIECC_FLAGS += --sysroot=${MLIR_AIE_SYSROOT} --host-target=aarch64-linux-gnu

# The following additional flags are only applied for host code. We add the
# necessary search paths for the sysroot so clang++ can find the aarch64
# includes and libraries.
AIECC_HOST_FLAGS += -I$(AIE_INSTALL)/runtime_lib $(AIE_INSTALL)/runtime_lib/test_library.cpp -I${MLIR_AIE_SYSROOT}/usr/include -I${MLIR_AIE_SYSROOT}/usr/include/c++/${LIBCXX_VERSION} -I${MLIR_AIE_SYSROOT}/usr/include/c++/${LIBCXX_VERSION}/aarch64-xilinx-linux -L${MLIR_AIE_SYSROOT}/usr/lib/aarch64-xilinx-linux/${LIBCXX_VERSION} -B${MLIR_AIE_SYSROOT}/usr/lib/aarch64-xilinx-linux/${LIBCXX_VERSION}

